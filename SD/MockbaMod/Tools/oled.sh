#!/bin/sh

# This is a test script for OLED display access proof of concept

c0="05 05 02 0A 05 05 02 0A 05 05 00 00"

c32="00 00 00 00 00 00 00 00 00 00 00 00"
c33="00 00 00 00 05 0F 00 00 00 00 00 00"
c34="00 00 00 07 00 00 00 07 00 00 00 00"
c35="01 04 07 0F 01 04 07 0F 01 04 00 00"
c36="02 04 02 0A 07 0F 02 0A 01 02 00 00"
c37="06 07 01 03 00 08 06 04 06 03 00 00"
c38="03 06 04 09 05 05 02 02 05 00 00 00"
c39="00 00 00 05 00 03 00 00 00 00 00 00"
c40="00 00 01 0C 02 02 04 01 00 00 00 00"
c41="00 00 04 01 02 02 01 0C 00 00 00 00"
c42="01 04 00 08 03 0E 00 08 01 04 00 00"
c43="00 08 00 08 03 0E 00 08 00 08 00 00"
c44="00 00 05 00 03 00 00 00 00 00 00 00"
c45="00 08 00 08 00 08 00 08 00 08 00 00"
c46="00 00 06 00 06 00 00 00 00 00 00 00"
c47="02 00 01 00 00 08 00 04 00 02 00 00"

c48="03 0E 05 01 04 09 04 05 03 0E 00 00"
c49="00 00 04 02 07 0F 04 00 00 00 00 00"
c50="04 02 06 01 05 01 04 09 04 06 00 00"
c51="02 01 04 01 04 05 04 0B 03 01 00 00"
c52="01 08 01 04 01 02 07 0F 01 00 00 00"
c53="02 07 04 05 04 05 04 05 03 09 00 00"
c54="03 0C 04 0A 04 09 04 09 03 00 00 00"
c55="00 03 00 01 07 01 00 09 00 07 00 00"
c56="03 06 04 09 04 09 04 09 03 06 00 00"
c57="00 06 04 09 04 09 02 09 01 0E 00 00"

c58="00 00 03 06 03 06 00 00 00 00 00 00"
c59="00 00 05 06 03 06 00 00 00 00 00 00"
c60="00 00 00 08 01 04 02 02 04 01 00 00"
c61="01 04 01 04 01 04 01 04 01 04 00 00"
c62="00 00 04 01 02 02 01 04 00 08 00 00"
c63="00 02 00 01 05 01 00 09 00 06 00 00"
c64="03 02 04 09 07 09 04 01 03 0E 00 00"

c65="07 0c 01 02 01 01 01 02 07 0c 00 00"
c66="07 0f 04 09 04 09 04 09 03 06 00 00"
c67="03 0e 04 01 04 01 04 01 02 02 00 00"
c68="07 0F 04 01 04 01 02 02 01 0C 00 00"
c69="07 0F 04 09 04 09 04 09 04 01 00 00"
c70="07 0F 00 09 00 09 00 09 00 01 00 00"
c71="03 0E 04 01 04 09 04 09 03 0A 00 00"
c72="07 0F 00 08 00 08 00 08 07 0F 00 00"
c73="00 00 04 01 07 0F 04 01 00 00 00 00"
c74="02 00 04 00 04 01 03 0F 00 01 00 00"
c75="07 0F 00 0C 01 02 02 01 04 00 00 00"
c76="07 0F 04 00 04 00 04 00 04 00 00 00"
c77="07 0F 00 02 00 0C 00 02 07 0F 00 00"
c78="07 0F 00 04 00 08 01 00 07 0F 00 00"
c79="03 0E 04 01 04 01 04 01 03 0E 00 00"
c80="07 0F 00 09 00 09 00 09 00 06 00 00"
c81="03 0E 04 01 05 01 02 01 05 0E 00 00"
c82="07 0F 00 09 01 09 02 09 04 06 00 00"
c83="02 06 04 09 04 09 04 09 03 02 00 00"
c84="00 01 00 01 07 0F 00 01 00 01 00 00"
c85="03 0F 04 00 04 00 04 00 03 0F 00 00"
c86="01 0F 02 00 04 00 02 00 01 0F 00 00"
c87="03 0F 04 00 03 08 04 00 03 0F 00 00"
c88="06 03 01 04 00 08 01 04 06 03 00 00"
c89="00 03 00 04 07 08 00 04 00 03 00 00"
c90="06 01 05 01 04 09 04 05 04 03 00 00"

c91="00 00 07 0F 04 01 04 01 00 00 00 00"
c92="00 02 00 04 00 08 01 00 02 00 00 00"
c93="00 00 04 01 04 01 07 0F 00 00 00 00"
c94="00 04 00 02 00 01 00 02 00 04 00 00"
c95="04 00 04 00 04 00 04 00 04 00 00 00"
c96="00 00 00 01 00 02 00 04 00 00 00 00"

c97="02 00 05 04 05 04 05 04 07 08 00 00"
c98="07 0F 04 08 04 04 04 04 03 08 00 00"
c99="03 08 04 04 04 04 04 04 02 00 00 00"
c100="03 08 04 04 04 04 04 08 07 0F 00 00"
c101="03 08 05 04 05 04 05 04 01 08 00 00"
c102="00 08 07 0E 00 09 00 01 00 02 00 00"
c103="00 08 05 04 05 04 05 04 03 0C 00 00"
c104="07 0F 00 08 00 04 00 04 07 08 00 00"
c105="00 00 04 08 07 0D 04 00 00 00 00 00"
c106="02 00 04 00 04 04 03 0D 00 00 00 00"
c107="07 0F 01 00 02 08 04 04 00 00 00 00"
c108="00 00 04 01 07 0F 04 00 00 00 00 00"
c109="07 0C 00 04 07 08 00 04 07 08 00 00"
c110="07 0C 00 08 00 04 00 04 07 08 00 00"
c111="03 08 04 04 04 04 04 04 03 08 00 00"
c112="07 0C 01 04 01 04 01 04 00 08 00 00"
c113="00 08 01 04 01 04 01 08 07 0C 00 00"
c114="07 0C 00 08 00 04 00 04 00 08 00 00"
c115="04 08 05 04 05 04 05 04 02 00 00 00"
c116="00 04 03 0F 04 04 04 00 02 00 00 00"
c117="03 0C 04 00 04 00 02 00 07 0C 00 00"
c118="01 0C 02 00 04 00 02 00 01 0C 00 00"
c119="03 0C 04 00 03 00 04 00 03 0C 00 00"
c120="04 04 02 08 01 00 02 08 04 04 00 00"
c121="00 0C 05 00 05 00 05 00 03 0C 00 00"
c122="04 04 06 04 05 04 04 0C 04 04 00 00"

c123="00 00 00 08 03 06 04 01 00 00 00 00"
c124="00 00 00 00 07 0F 00 00 00 00 00 00"
c125="00 00 04 01 03 06 00 08 00 00 00 00"
c126="01 00 00 08 00 08 01 00 00 08 00 00"
c127="07 08 04 04 04 02 04 04 07 08 00 00"

c128="00 00 03 0E 02 02 03 0E 00 00 00 00"
c129="00 00 00 00 03 0E 00 00 00 00 00 00"
c130="00 00 03 0A 02 0A 02 0E 00 00 00 00"
c131="00 00 02 0A 02 0A 03 0E 00 00 00 00"
c132="00 00 00 0E 00 08 03 0E 00 00 00 00"
c133="00 00 02 0E 02 0A 03 0A 00 00 00 00"
c134="00 00 03 0E 02 0A 03 0A 00 00 00 00"
c135="00 00 00 02 00 02 03 0E 00 00 00 00"
c136="00 00 03 0E 02 0A 03 0E 00 00 00 00"
c137="00 00 02 0E 02 0A 03 0E 00 00 00 00"
c138="00 00 03 0E 00 0A 03 0E 00 00 00 00"
c139="00 00 03 0E 02 08 03 08 00 00 00 00"
c140="00 00 03 0E 02 02 02 02 00 00 00 00"
c141="00 00 03 08 02 08 03 0E 00 00 00 00"
c142="00 00 03 0E 02 0A 02 0A 00 00 00 00"
c143="00 00 03 0E 00 0A 00 0A 00 00 00 00"

dev=`amidi -l | grep Private | cut -b5-13`
lin=$2
msg=""
len=5
col=0
str=$3
l=${#str}
l=$((l-1))

for i in `seq 0 $l`
do
	j=${str:$i:1}
	len=$((len+12))
	col=$((col+6))
	s=`printf '%d' "'$j"`
	eval s="\$c$s"
	if [ "$s" == "" ]
	then
		s=$c0
	fi
	msg="$msg$s "
done
len=`printf "%02x" $len`
col=`printf "%02x" $col`
dis=`printf "%02x" $1`
lin=`printf "%02x" $2`
msg="amidi -p $dev -S 'f0 47 7f 40 0c 00 $len $dis $lin $lin 00 $col $msg f7'"
eval $msg
